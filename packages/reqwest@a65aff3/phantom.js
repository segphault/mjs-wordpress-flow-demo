var page=require("webpage").create();page.open("http://localhost:1234",function(){function e(){setTimeout(function(){var t=page.evaluate(function(){var e=document.getElementById("tests");return e.className});if(t.match(/sink-done/)){var n=page.evaluate(function(){for(var e="",t=document.querySelectorAll("ol#tests .fail .fail"),n=0;t.length>n;n++)e+=t[n].textContent+"\n";return{text:e,count:t.length}}),i=!!t.match(/sink-pass/);i?console.log("All tests have passed!"):(console.log(n.count+" test(s) failed"),console.log(n.text.trim())),phantom.exit(i?0:1)}else e()},10)}e()});